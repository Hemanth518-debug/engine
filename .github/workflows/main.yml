
name: Build

on:
  push:
    branches:
      - flutter-*-webos
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest
    container:
      image: myimage:v2

    strategy:
      matrix:
        arch: [arm]
        mode: [debug]
        include:
          - arch: arm
            triple: arm-linux-gnueabi

    env:
      OUTPUT_NAME: linux_${{ matrix.mode }}_${{ matrix.arch }}

    steps:
      - uses: actions/checkout@v3
        with:
          path: src/flutter
          fetch-depth: 0
      - name: install depot_tools
        run: |
          git clone --depth=1 https://chromium.googlesource.com/chromium/tools/depot_tools.git
          echo "$PWD/depot_tools" >> $GITHUB_PATH

      
      
      - name: gclient sync
        run: |
          gclient config --name=src/flutter --unmanaged https://github.com/Hemanth518-debug/engine
      
          gclient sync -v --no-history --shallow

      - name: verify formatting
        if: matrix.arch == 'arm' && matrix.mode == 'debug'
        working-directory: src/flutter
        run: |
          git remote add upstream https://github.com/flutter/engine.git
          gclient sync -D
          ci/format.sh
      - name: build
        run: |
          echo "beforegn"
          cd /flutter/sysroot/o20-sysroot-for-flutter
          src/flutter/tools/gn --target-sysroot /flutter/sysroot/O20_SDK_webOS_403/lib32-recipe-sysroot --target-toolchain /flutter/toolchain-version-2 --target-triple arm-starfishmllib32-linux-gnueabi --linux-cpu arm --runtime-mode debug --embedder-for-target --no-lto --target-os linux --arm-float-abi softfp --disable-desktop-embeddings
          echo "aftergn"
          ninja -C out/linux_debug_arm -j 32
          echo "afterninja"
         
     
